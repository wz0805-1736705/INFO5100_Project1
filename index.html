<!DOCTYPE html>
<html>

<head>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
    <div id="barRight"></div>
    <script>
        d3.json("../dataset/dc_data.json").then((data) => {
            /*let hairArr = []
            data.forEach((d, i) => {
                hairArr[i] = d['HAIR'];
            });
            const occurrences = hairArr.reduce(function (acc, curr) {
            return acc[curr] ? ++acc[curr] : acc[curr] = 1, acc
            }, {});
            console.log(occurrences);
            let eyeArr = []
            data.forEach((d, i) => {
                eyeArr[i] = d['EYE'];
            });
            const occurrencesEYE = eyeArr.reduce(function (acc, curr) {
            return acc[curr] ? ++acc[curr] : acc[curr] = 1, acc
            }, {});

            console.log(occurrencesEYE);
            */
            let eachCountR = [];
            let colCountR = 18;
            for (let i = 0; i < colCountR; i++) {
                eachCountR[i] = 0;
            }
            let totalCountR = 0;
            let colNames = ['Male', 'Female', 'Other Gender', 'Public Identity', 'Secret Identity', 'Other/Unknown Identity', 'Good Characters', 'Neutral Characters', 'Bad Characters', 'Living Characters', 'Deceased Characters', 'Black Hair', 'Brown Hair', 'Blond Hair', 'Other Hair Colors', 'Blue Eyes', 'Brown Eyes', 'Other Eye Colors'];
            data.forEach((d, i) => {
                totalCountR++;
                if (d['SEX'] == 'Male Characters') {
                    eachCountR[0]++;
                } else if (d['SEX'] == 'Female Characters') {
                    eachCountR[1]++;
                } else {
                    eachCountR[2]++;
                }
                 
                if (d['ID'] == 'Public Identity') {
                    eachCountR[3]++;
                } else if (d['ID'] == 'Secret Identity') {
                    eachCountR[4]++;
                } else {
                    eachCountR[5]++;
                }
                if (d['ALIGN'] == 'Good Characters') {
                    eachCountR[6]++;
                } else if (d['ALIGN'] == 'Neutral Characters') {
                    eachCountR[7]++;
                } else {
                    eachCountR[8]++;
                }
                if (d['ALIVE'] == 'Living Characters') {
                    eachCountR[9]++;
                } else {
                    eachCountR[10]++;
                }
                if (d['HAIR'] == 'Black Hair') {
                    eachCountR[11]++;
                } else if (d['HAIR'] == 'Brown Hair') {
                    eachCountR[12]++;
                } else if (d['HAIR'] == 'Blond Hair') {
                    eachCountR[13]++;
                } else {
                    eachCountR[14]++;
                }
                if (d['EYE'] == 'Blue Eyes') {
                    eachCountR[15]++;
                } else if (d['EYE'] == 'Brown Eyes') {
                    eachCountR[16]++;
                } else if (d['EYE'] != "") {
                    eachCountR[17]++;
                }
            });
            console.log(totalCountR);
            let svg = d3.select('#barRight')
                .append('svg')
                .attr('width', 600)
                .attr('height', 600);
            svg.append('image')
                .attr('x', 350)
                .attr('y', 10)
                .attr('width', 80)
                .attr('height', 80)
                .attr('href', '../pics/dc_logo.png');
            svg.append('image')
                .attr('x', 130)
                .attr('y', 10)
                .attr('width', 120)
                .attr('height', 80)
                .attr('href', '../pics/marvel_logo.png');
            let yScaleR = d3.scaleLinear().domain([0, totalCountR]).range([0, 220]);
            let xScaleR = d3.scaleLinear().domain([0, colCountR]).range([100, 600]);
            console.log(eachCountR);
            for (let i = 0; i < colCountR; i++) {
                svg.append('rect')
                    .attr('x', 300)
                    .attr('y', xScaleR(i + 0.5))
                    .attr('width', yScaleR(eachCountR[i]))
                    .attr('height', 10)
                    .style('fill', '#0272E8');
                svg.append('text')
                    .attr('x', 300 + yScaleR(eachCountR[i]) + 5)
                    .attr('y', xScaleR(i + 0.5) + 5)
                    .attr('text-anchor', 'start')
                    .attr('dominant-baseline', 'middle')
                    .attr("font-size","13px")
                    .text(Math.floor(eachCountR[i] / totalCountR * 100) + '%')
                    .style('fill', 'darkBlue');
                svg.append('text')
                    .attr('x', 300)
                    .attr('y', xScaleR(i))
                    .attr('text-anchor', 'middle')
                    .attr('dominant-baseline', 'hanging')
                    .text(colNames[i])
                    .style('fill', 'black')
                    .style('font-size', 13);
            };
        //     const width = svg.attr("width");
        //   const height = svg.attr("height");
        const width = 600;
          const height = 600;
          
          d3.json("../dataset/marveldata.json")
            .then((data) => {
              console.log(data);
              console.log(data.length);
              let lmale = 0;
              let lfemale = 0;
              let lgsm = 0;
              let lsi = 0;
              let lpi = 0;
              let lndi = 0;
              let ldata = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
              let numAttr = 18;
            //   data = data.filter( (d) => {return d['carat'] != 0 && d['price'] != 0} );
              // console.log(data.length);
              data.forEach( (d,i) => {
                  if (d['SEX'] == "Male Characters"){
                      ldata[0]++;
                  }
                  if (d['SEX'] == "Female Characters"){
                    ldata[1]++;
                  }
                  if (d['GSM'] != "" || (d['SEX'] != "Female Characters" && d['SEX'] != "Male Characters")){
                    ldata[2]++;
                  }
                  if (d['ID'] == "Secret Identity"){
                    ldata[3]++;
                  }
                  if (d['ID'] == "Public Identity"){
                    ldata[4]++;
                  }
                  if (d['ID'] != "Public Identity" && d['ID'] != "Secret Identity" && d['ID'] != ""){
                    ldata[5]++;
                  }
                  if (d['ALIGN'] == "Good Characters"){
                    ldata[6]++;
                  }
                  if (d['ALIGN'] == "Bad Characters"){
                    ldata[7]++;
                  }
                  if (d['ALIGN'] == "Neutral Characters"){
                    ldata[8]++;
                  }
                  if (d['ALIVE'] == "Living Characters"){
                    ldata[9]++;
                  }
                  if (d['ALIVE'] == "Deceased Characters"){
                    ldata[10]++;
                  }
                  if (d['HAIR'] == "Black Hair"){
                    ldata[11]++;
                  }
                  if (d['HAIR'] == "Brown Hair"){
                    ldata[12]++;
                  }
                  if (d['HAIR'] == "Blond Hair"){
                    ldata[13]++;
                  }
                  if (d['HAIR'] != "Black Hair" && d['HAIR'] !="Blonde Hair" && d['HAIR'] !="Brown Hair"){
                    ldata[14]++;
                  }
                  if (d['EYE'] == "Blue Eyes"){
                    ldata[15]++;
                  }
                  if (d['EYE'] == "Brown Eyes"){
                    ldata[16]++;
                  }
                  if (d['EYE'] != "Blue Eyes" && d['EYE'] !="Brown Eyes" && d['EYE'] !=""){
                    ldata[17]++;
                  }
                  
              });
            
              let lxScale = d3.scaleLinear().domain([0,16376]).range([width/2, 30]);
              let lyScale = d3.scaleLinear().domain([0,numAttr]).range([100, height]);

              for (let i = 0; i < numAttr; i++){
                svg.append('rect')
                        .attr('x', lxScale(ldata[i]))
                        .attr('y', lyScale(i+0.5))
                        .attr('width', width/2 - lxScale(ldata[i]))
                        .attr('height', 10)
                        .style("fill", "#DC0319");
                svg.append("text")
                        .attr("text-anchor","end")
                        .attr("font-size","13px")
                        .attr("dominant-baseline", "middle")
                        .attr("x",(lxScale(ldata[i])-5))
                        .attr("y",(lyScale(i+0.5)+5))
                        .style("fill", "#DC0319")
                        .text(Math.floor(100 *ldata[i]/data.length)+"%");

              }
            
              let hairArr = []
                data.forEach((d, i) => {
                    hairArr[i] = d['HAIR'];
                });
                const hairoccurrences = hairArr.reduce(function (acc, curr) {
                return acc[curr] ? ++acc[curr] : acc[curr] = 1, acc
                }, {});

                console.log(hairoccurrences);
            let eyeArr = []
                data.forEach((d, i) => {
                    eyeArr[i] = d['EYE'];
                });
                const eyeoccurrences = eyeArr.reduce(function (acc, curr) {
                return acc[curr] ? ++acc[curr] : acc[curr] = 1, acc
                }, {});

                console.log(eyeoccurrences);
            });
            
        });
    </script>
</body>

</html>